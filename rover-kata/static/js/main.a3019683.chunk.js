(this["webpackJsonprover-kata"]=this["webpackJsonprover-kata"]||[]).push([[0],{11:function(t,e,s){t.exports=s(20)},17:function(t,e,s){},18:function(t,e,s){},19:function(t,e,s){},20:function(t,e,s){"use strict";s.r(e);var i=s(0),a=s.n(i),n=s(5),o=s.n(n),r=(s(17),s(2)),c=s(3),l=s(7),u=s(6),h=s(1),d=s(8),m=(s(18),function(t){function e(t){var s;return Object(r.a)(this,e),(s=Object(l.a)(this,Object(u.a)(e).call(this,t))).state={value:t.value,isValid:!0},s.handleChange=s.handleChange.bind(Object(h.a)(s)),s}return Object(d.a)(e,t),Object(c.a)(e,[{key:"handleChange",value:function(t){this.setState({value:t.target.value,isValid:this.props.validator.test(t.target.value)})}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("label",{htmlFor:this.props.id},this.props.label),a.a.createElement("input",{type:this.props.type,id:this.props.id,value:this.state.value,onChange:this.handleChange,autoFocus:!0}),a.a.createElement("div",{className:this.state.isValid?"input-hint":"input-hint-warning"},this.props.hint))}}]),e}(i.Component)),p=function(t){var e,s,i,n;switch(t.step){case 1:s="Welcome to Mars Rover kata!",i=t.currentGridSize,n="set-grid-size",e=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"input-field"},a.a.createElement(m,{type:"number",value:t.currentGridSize,label:"Set grid size:",id:n,hint:"Integer between 5 and 25",validator:/(^[5-9]$|^1[0-9]$|^2[0-5]$)/})),a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){(i=document.getElementById(n).value)!==t.currentGridSize?t.updateGridSize(i):t.nextMessage()}},"Next")));break;case 2:s="Click on map to set obstacles",e=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){t.nextMessage()}},"Next")));break;case 3:s="Click on map to put a rover",e="";break;case 4:i="",n="set-grid-size",s="Upload commands for the rover",e=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"input-field"},a.a.createElement(m,{type:"text",value:"",label:"Commands:",id:n,hint:"f - go forward; b - go backward; s - skip move; l - turn left; r - turn right",validator:/^[fbrls]+$/})),a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){""!==(i=document.getElementById(n).value)?t.addRoverCommands(i):t.nextMessage()}},"Next")));break;case 5:t.roverCount>=4?t.nextMessage():(s="Add another rover?",e=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){t.nextMessage(3)}},"Yes"),a.a.createElement("button",{type:"button",onClick:function(){t.nextMessage()}},"No"))));break;case 6:s="Set rover speed",i="2",n="set-mps",e=a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"input-field"},a.a.createElement(m,{type:"number",value:"2",label:"Moves per second:",id:n,hint:"Integer between 1 and 25",validator:/(^[1-9]$|^1[0-9]$|^2[0-5]$)/})),a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){i=document.getElementById(n).value,t.runMap(i)}},"Run")));break;case 7:s="Go, rover, go!",e="";break;case 8:s="Race is over!",e=a.a.createElement("div",{className:"submit-field"},a.a.createElement("button",{type:"button",onClick:function(){t.viewTravelLog()}},"View Travel Log"),a.a.createElement("button",{type:"button",onClick:function(){t.resetGrid()}},"Start again"));break;default:s="Something went wrong!"}return a.a.createElement("div",{className:"dialog-card"},a.a.createElement("h3",null,s),e)},v=(s(19),function(t){var e=document.getElementById("travel-log"),s=a.a.createElement("div",{className:"travel-log"},a.a.createElement("div",{className:"content-wrapper"},a.a.createElement("h1",null,"Travel Log"),a.a.createElement("button",{type:"button",onClick:t.resetGrid},"Start again"),a.a.createElement("div",{className:"flex-row"},t.rovers.map((function(t,e){return a.a.createElement("div",{className:"log-panel",key:"log-panel-".concat(e)},a.a.createElement("h3",null,t.name),a.a.createElement("ul",{className:"log-list"},t.travelLog.map((function(t,e){var s=t.message;return a.a.createElement("li",{key:"message-".concat(e)},s)}))))})))));return o.a.createPortal(s,e)}),g=s(4),b=s(9),y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"n",n=arguments.length>4?arguments[4]:void 0;Object(r.a)(this,t);var o=["Curiosity","Spirit","Opportunity","Sojourner"];this.id=e,this.name=o[e-1]||o[0],this.direction=a,this.x=s,this.y=i,this.position=[s,i],this.travelLog=[],this.status="moving",this.missionResult="running",this.compass=["n","e","s","w"],this.commands=[],this.movesSkipped=0,this.map=n,"clear"===n.getCellInfo(s,i).status?(n.addRover(this,s,i),this.travelLog.push({message:"Initialized on position x: ".concat(this.x,", y: ").concat(this.y,". Turning power on and ready to roll..."),missionStatus:this.missionResult,status:this.status})):(this.map={},console.error("Cannot add rover on the map. Reassign position or add new map"))}return Object(c.a)(t,[{key:"changePosition",value:function(t){var e=Object(b.a)(t,2),s=e[0],i=e[1];this.x=s,this.y=i,this.position=[s,i]}},{key:"addMap",value:function(t){"clear"===t.getCellInfo(this.x,this.y).status?(this.map=t,t.addRover(this,this.x,this.y)):(this.map={},console.error("Cannot add rover on the map. Reassign position or add new map"))}},{key:"turnLeft",value:function(){var t=this.compass.indexOf(this.direction)-1;this.direction=this.compass[t<0?3:t],this.status=this.commands.length?this.status:"stopped",this.missionResult=this.commands.length?this.missionResult:"accomplished",this.travelLog.push({message:"Turned left on position x: ".concat(this.x,", y: ").concat(this.y,".").concat("accomplished"===this.missionResult?"\nMission accomplished!":""),missionStatus:this.missionResult,status:this.status}),this.map.recordMove()}},{key:"turnRight",value:function(){var t=this.compass.indexOf(this.direction)+1;this.direction=this.compass[t>3?0:t],this.status=this.commands.length?this.status:"stopped",this.missionResult=this.commands.length?this.missionResult:"accomplished",this.travelLog.push({message:"Turned right on position x: ".concat(this.x,", y: ").concat(this.y,".").concat("accomplished"===this.missionResult?"\nMission accomplished!":""),missionStatus:this.missionResult,status:this.status}),this.map.recordMove()}},{key:"skipMove",value:function(){this.movesSkipped<3?(this.status=this.commands.length?this.status:"stopped",this.missionResult=this.commands.length?this.missionResult:"accomplished",this.travelLog.push({message:"Skipped move on position x: ".concat(this.x,", y: ").concat(this.y,".").concat("accomplished"===this.missionResult?"\nMission accomplished!":""),missionStatus:this.missionResult,status:this.status}),this.map.recordMove()):this.stop("occupied cell")}},{key:"stop",value:function(t){this.status="stopped",this.missionResult="failed",this.commands=[],this.travelLog.push({message:"Stuck on position x: ".concat(this.x,", y: ").concat(this.y,". Reached ").concat(t,". Turning power off, waiting for new instructions..."),missionStatus:this.missionResult,status:this.status}),this.map.recordMove()}},{key:"moveForward",value:function(t){var e,s;switch(this.direction){case"n":e=this.x,s=this.y-1;break;case"e":e=this.x+1,s=this.y;break;case"s":e=this.x,s=this.y+1;break;case"w":e=this.x-1,s=this.y;break;default:this.skipMove(),this.movesSkipped++}var i=this.map.getCellInfo(e,s);switch(i.status){case"clear":var a=Object(b.a)(this.position,2),n=a[0],o=a[1];this.x=e,this.y=s,this.position=[e,s],this.status=this.commands.length?this.status:"stopped",this.missionResult=this.commands.length?this.missionResult:"accomplished",this.travelLog.push({message:"Moved forward to position x: ".concat(e,", y: ").concat(s,".").concat("accomplished"===this.missionResult?"\nMission accomplished!":""),missionStatus:this.missionResult,status:this.status}),this.map.moveRover(this,e,s),this.map.clearCell(n,o),this.map.recordMove();break;case"occupied":case"error":this.skipMove(),this.movesSkipped++,this.commands.push(t);break;case"unreachable":this.stop(i.id);break;default:this.skipMove(),this.movesSkipped++,this.commands.push(t)}}},{key:"moveBackward",value:function(t){var e,s;switch(this.direction){case"n":e=this.x,s=this.y+1;break;case"e":e=this.x-1,s=this.y;break;case"s":e=this.x,s=this.y-1;break;case"w":e=this.x+1,s=this.y;break;default:this.skipMove(),this.movesSkipped++}var i=this.map.getCellInfo(e,s);switch(i.status){case"clear":var a=Object(b.a)(this.position,2),n=a[0],o=a[1];this.x=e,this.y=s,this.position=[e,s],this.status=this.commands.length?this.status:"stopped",this.missionResult=this.commands.length?this.missionResult:"accomplished",this.travelLog.push({message:"Moved backward to position x: ".concat(e,", y: ").concat(s,"."),missionStatus:this.missionResult,status:this.status}),this.map.moveRover(this,e,s),this.map.clearCell(n,o),this.map.recordMove();break;case"occupied":case"error":this.skipMove(),this.movesSkipped++,this.commands.push(t);break;case"unreachable":this.stop(i.id);break;default:this.skipMove(),this.movesSkipped++,this.commands.push(t)}}},{key:"addCommands",value:function(t){if("string"===typeof t){t=t.replace(/\s/g,"");var e=!0,s=!1,i=void 0;try{for(var a,n=t[Symbol.iterator]();!(e=(a=n.next()).done);e=!0){var o=a.value;this.commands.unshift(o)}}catch(r){s=!0,i=r}finally{try{e||null==n.return||n.return()}finally{if(s)throw i}}}else Array.isArray(t)?(t=t.map((function(t){return t.trim().charAt[0]})),this.commands=[].concat(Object(g.a)(t.reverse()),Object(g.a)(this.commands))):console.error("Couldn't recognize input. Must be a string or array of commands")}},{key:"move",value:function(){if("stopped"!==this.status){var t=this.commands.pop();switch(!0){case/f/i.test(t):this.moveForward(t);break;case/b/i.test(t):this.moveBackward(t);break;case/l/i.test(t):this.turnLeft();break;case/r/i.test(t):this.turnRight();break;case/s/i.test(t):this.skipMove();break;default:this.skipMove(),this.movesSkipped++}}}}]),t}(),f=function(){function t(e,s){Object(r.a)(this,t),this.xSize=e,this.ySize=s,this.map=Object(g.a)(Array(s)).map((function(t){return Array(e).fill(0)})),this.history=[],this.rovers=[],this.roverCount=0}return Object(c.a)(t,[{key:"addObstacle",value:function(t,e){0===this.map[e][t]?this.map[e][t]="X":console.error("Position x: ".concat(t,", y: ").concat(e," is taken or non-existent"))}},{key:"addRover",value:function(t,e,s){this.roverCount>3?console.error("Maximum number of rovers (4) reached"):0===this.map[s][e]?(this.map[s][e]=t,this.rovers.push(t),this.roverCount++,this.recordMove()):console.error("Position x: ".concat(e,", y: ").concat(s," is taken or non-existent"))}},{key:"moveRover",value:function(t,e,s){this.map[s][e]=t}},{key:"clearCell",value:function(t,e){this.map[e][t]=0}},{key:"getCellInfo",value:function(t,e){switch(!0){case t<0||t>=this.xSize||e<0||e>=this.ySize:return{status:"unreachable",id:"end of map"};case 0===this.map[e][t]:return{status:"clear",id:0};case"X"===this.map[e][t]:return{status:"unreachable",id:"obstacle"};case this.map[e][t]instanceof y:return{status:"moving"===this.map[e][t].status?"occupied":"unreachable",id:"rover"};default:return console.error("Couldn't recognize position or object on position x: ".concat(t,", y: ").concat(e,".")),{status:"error",id:-1}}}},{key:"recordMove",value:function(){var t=[];this.map.forEach((function(e){return t.push(Object(g.a)(e).map((function(t){if(t instanceof y){var e={};return e.id=t.id,e.direction=t.direction,e.status="moving"===t.status?t.status:"failed"===t.missionResult?t.status:"finished",e}return t})))})),this.history.push(t)}},{key:"run",value:function(t){var e=this;t=void 0===t?0:parseInt(t)>0&&parseInt(t)<11?parseInt(t):2;var s=0,i=setInterval((function(){-1===(s=function t(e,s,i){return e.filter(i).length?s<e.length&&i(e[s])?s:t(e,s>=e.length-1?0:++s,i):-1}(e.rovers,s,(function(t){return"moving"===t.status})))?clearInterval(i):e.rovers[s++].move()}),0===t?t:1e3/t)}}]),t}(),k={},S=function(t){function e(){var t;return Object(r.a)(this,e),(t=Object(l.a)(this,Object(u.a)(e).call(this))).state={grid:{xSize:10,ySize:10},layout:[],listening:!1,controlStep:1,prinntTravelLog:!1},t.updateGridSize=t.updateGridSize.bind(Object(h.a)(t)),t.nextMessage=t.nextMessage.bind(Object(h.a)(t)),t.addObstacle=t.addObstacle.bind(Object(h.a)(t)),t.handleObstacleClick=t.handleObstacleClick.bind(Object(h.a)(t)),t.addRover=t.addRover.bind(Object(h.a)(t)),t.handleRoverClick=t.handleRoverClick.bind(Object(h.a)(t)),t.addRoverCommands=t.addRoverCommands.bind(Object(h.a)(t)),t.runMap=t.runMap.bind(Object(h.a)(t)),t.printTravelLog=t.printTravelLog.bind(Object(h.a)(t)),t.reset=t.reset.bind(Object(h.a)(t)),t}return Object(d.a)(e,t),Object(c.a)(e,[{key:"componentWillMount",value:function(){document.body.style.setProperty("--grid-x-size",this.state.grid.xSize),document.body.style.setProperty("--grid-y-size",this.state.grid.ySize)}},{key:"componentWillUpdate",value:function(t,e){var s=e.controlStep,i=e.listening;2!==s&&3!==s||i?2!==s&&3!==s&&i&&this.setState({listening:!1}):this.setState({listening:!0})}},{key:"componentDidUpdate",value:function(){var t=this.state,e=t.controlStep,s=t.grid;switch(e){case 2:document.body.style.setProperty("--grid-x-size",s.xSize),document.body.style.setProperty("--grid-y-size",s.ySize),document.getElementById("grid").addEventListener("click",this.handleObstacleClick);break;case 3:document.getElementById("grid").removeEventListener("click",this.handleObstacleClick),document.getElementById("grid").addEventListener("click",this.handleRoverClick);break;case 4:document.getElementById("grid").removeEventListener("click",this.handleRoverClick)}}},{key:"componentDidMount",value:function(){var t=this.state.grid;k=new f(t.xSize,t.ySize),this.setState({layout:k.map})}},{key:"updateGridSize",value:function(t){t=Number(t)>4&&Number(t)<26?Number(t):10,k=new f(t,t),this.setState({grid:{xSize:t,ySize:t},layout:k.map,controlStep:1===this.state.controlStep?2:this.state.controlStep})}},{key:"nextMessage",value:function(t){t=t||this.state.controlStep+1,this.setState({controlStep:t})}},{key:"addObstacle",value:function(t,e){k.addObstacle(t,e),this.setState({layout:k.map})}},{key:"handleObstacleClick",value:function(t){var e=this.state.grid.xSize;if(t.target.classList.contains("listen")){var s=t.target.id%e,i=Math.floor(t.target.id/e);this.addObstacle(s,i)}}},{key:"handleRoverClick",value:function(t){var e=this.state.grid.xSize;if(t.target.classList.contains("listen")){var s=t.target.id%e,i=Math.floor(t.target.id/e);this.addRover(s,i)}}},{key:"addRover",value:function(t,e){var s=k.roverCount||0;new y(s+1,t,e,"n",k);this.setState({layout:k.history[k.history.length-1],controlStep:this.state.controlStep+1})}},{key:"addRoverCommands",value:function(t){k.rovers[k.rovers.length-1].addCommands(t),this.nextMessage()}},{key:"printTravelLog",value:function(){this.setState({prinntTravelLog:!0})}},{key:"reset",value:function(){k={},this.setState({grid:{xSize:10,ySize:10},layout:[],listening:!1,controlStep:1,prinntTravelLog:!1})}},{key:"runMap",value:function(t){var e=this;t=(t=parseInt(t))>0&&t<25?t:2,k.run();var s=0,i=setInterval((function(){s>=k.history.length-1&&(clearInterval(i),i=null),e.setState({layout:k.history[s],controlStep:i?7:8}),s++}),1e3/t)}},{key:"render",value:function(){var t=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"flex-row"},a.a.createElement("div",{className:"grid-container flex-center"},a.a.createElement("div",{className:"grid",id:"grid"},this.state.layout.flat().map((function(e,s){var i=["grid-cell"];return"X"===e&&i.push("x"),e instanceof Object&&(i.push("rover","rover-".concat(e.id),"rover-".concat(e.direction)),"stopped"===e.status&&i.push("stuck"),"finished"===e.status&&i.push("won")),t.state.listening&&0===e&&i.push("listen"),a.a.createElement("div",{className:i.join(" "),key:"cell-".concat(s),id:s})})))),a.a.createElement("div",{className:"controls-container flex-center"},a.a.createElement(p,{step:this.state.controlStep,currentGridSize:this.state.grid.xSize,updateGridSize:this.updateGridSize,nextMessage:this.nextMessage,roverCount:k.hasOwnProperty("roverCount")?k.roverCount:0,addRoverCommands:this.addRoverCommands,runMap:this.runMap,viewTravelLog:this.printTravelLog,resetGrid:this.reset}))),this.state.prinntTravelLog?a.a.createElement(v,{rovers:k.rovers,resetGrid:this.reset}):null)}}]),e}(i.Component),x=document.getElementById("root");o.a.render(a.a.createElement(S,null),x)}},[[11,1,2]]]);
//# sourceMappingURL=main.a3019683.chunk.js.map